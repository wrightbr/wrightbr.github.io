<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guess the Haulout Location</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f0f0f0;
            padding: 20px;
        }
        img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        input[type="text"] {
            padding: 10px;
            font-size: 16px;
            width: 200px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
            background-color: #007bff;
            color: white;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        #result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        #locationList {
            margin-top: 20px;
            font-size: 16px;
            display: none; /* Hidden by default */
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #007bff;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        #montage {
            display: none; /* Hidden by default */
            margin-top: 20px;
        }
        #montage img {
            width: 150px;
            height: 100px;
            object-fit: cover;
            margin: 5px;
            border-radius: 5px;
        }
        #counter {
            margin-top: 10px;
            font-size: 16px;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <h1>Guess the Haulout Location</h1>
    <p>Look at the picture below and guess the name of the haulout location!</p>

    <img id="locationImage" src="" alt="Haulout Location Image">
    <br>
    <input type="text" id="guessInput" placeholder="Enter haulout location" disabled>
    <button onclick="checkGuess()" disabled>Submit</button>
    <button id="nextLocationButton" onclick="nextLocation()" disabled>Next Location</button>

    <div id="result"></div>
    <div id="counter"></div> <!-- Counter for quiz progress -->

    <!-- Toggle switch for location list -->
    <div>
        <label class="switch">
            <input type="checkbox" id="toggleLocationList" onchange="toggleLocationList()">
            <span class="slider"></span>
        </label>
        <span>Show Location List</span>
    </div>

    <!-- List of possible locations -->
    <div id="locationList">
        <h3>Possible Locations:</h3>
        <ul id="locationListItems"></ul>
    </div>

    <!-- Montage of all location images -->
    <div id="montage">
        <h2>Game Over! Here are all the locations you saw:</h2>
        <div id="montageImages"></div>
    </div>

    <script>
        // Embedded data: URLs and names of haulout locations
        const locations = [
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Alsea_Bay_20240531.jpg", Name: "Alsea Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Bandon_20240529.jpg", Name: "Bandon" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Blacklock_Point_20240529.jpg", Name: "Blacklock Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Blanco_Reef_20240529.jpg", Name: "Blanco Reef" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Boiler_Bay_20240531.jpg", Name: "Boiler Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Camas_Powerlines_20230427.jpg", Name: "Camas Powerlines" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Arago_20230905.jpg", Name: "Cape Arago" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Blanco_20240529.jpg", Name: "Cape Blanco" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Falcon_20240531.jpg", Name: "Cape Falcon" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Foulweather_20240531.jpg", Name: "Cape Foulweather" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Lookout_20240531.jpg", Name: "Cape Lookout" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Perpetua_20240529.jpg", Name: "Cape Perpetua" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cascade_Head_20230905.jpg", Name: "Cascade Head" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Castle_Rock_20240529.jpg", Name: "Castle Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Chinook_Baker_20210518.jpg", Name: "Baker Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Coffin_Rock_20250109.jpg", Name: "Coffin Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Coos_Bay_20240529.jpg", Name: "Coos Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cowlitz_River_Mouth_20220323.jpg", Name: "Cowlitz River Mouth" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Deer_Point_20240529.jpg", Name: "Deer Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Desdemona_Sands_20240531.jpg", Name: "Desdemona Sands" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Devils_Backbone_20240529.jpg", Name: "Devils Backbone" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/East_Mooring_Basin_20230905.jpg", Name: "East Mooring Basin" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Ecola_Point_20240531.jpg", Name: "Ecola Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Fivemile_Point_20240529.jpg", Name: "Fivemile Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Fogarty_Creek_20240531.jpg", Name: "Fogarty Creek" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Goat_Island_20240529.jpg", Name: "Goat Island" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Grays_Bay_20240531.jpg", Name: "Grays Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Green_Island_Area_20240531.jpg", Name: "Green Island Area" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Gull_Rock_20240529.jpg", Name: "Gull Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/House_Rock_20240529.jpg", Name: "House Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Hubbard_Mound_20240529.jpg", Name: "Hubbard Mound" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Humbug_Mountain_20240529.jpg", Name: "Humbug Mountain" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Hunters_Island_20240529.jpg", Name: "Hunters Island" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Jetty_A_20240531.jpg", Name: "Jetty A" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Mack_Reef_Crook_Point_20230905.jpg", Name: "Mack Reef Crook Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Nehalem_River_20240531.jpg", Name: "Nehalem River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Nestucca_River_20240531.jpg", Name: "Nestucca River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Netarts_Bay_20240531.jpg", Name: "Netarts Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Orford_Reef_20230905.jpg", Name: "Orford Reef" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Phoca_Rock_20100317.jpg", Name: "Phoca Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Pillar_Welch_20210518.jpg", Name: "Three Tree Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Pirate_Cove_20240531.jpg", Name: "Pirate Cove" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Pistol_River_20240529.jpg", Name: "Pistol River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Port_Orford_Heads_20240529.jpg", Name: "Port Orford Heads" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Puget_Wallace_20210518.jpg", Name: "Wallace Island" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Qochyax_Island_20240529.jpg", Name: "Qochyax Island" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Rainier_20240208.jpg", Name: "Rainier" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Rogue_Reef_20240529.jpg", Name: "Rogue Reef" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Rogue_River_20240529.jpg", Name: "Rogue River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Sea_Lion_Caves_20230905.jpg", Name: "Sea Lion Caves" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Seal_Rock_20240531.jpg", Name: "Seal Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Shore_Acres_20240529.jpg", Name: "Shore Acres" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Siletz_Bay_20240531.jpg", Name: "Siletz Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Siltcoos_Lake_Outlet_20240529.jpg", Name: "Siltcoos Lake Outlet" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Siuslaw_River_20240529.jpg", Name: "Siuslaw River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/South_Jetty_20230905.jpg", Name: "South Jetty" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Strawberry_Hill_20240529.jpg", Name: "Strawberry Hill" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tahkenitch_Lake_Outlet_20240529.jpg", Name: "Tahkenitch Lake Outlet" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Taylor_Sands_20240531.jpg", Name: "Taylor Sands" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tenmile_Lake_Outlet_20240529.jpg", Name: "Tenmile Lake Outlet" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Three_Arch_Rocks_20230905.jpg", Name: "Three Arch Rocks" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tillamook_Bay_20240531.jpg", Name: "Tillamook Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tillamook_Head_20240531.jpg", Name: "Tillamook Head" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tillamook_Head_Lighthouse_20230905.jpg", Name: "Tillamook Head Lighthouse" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tokatee_Klootchman_20240529.jpg", Name: "Tokatee Klootchman" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Umpqua_River_20240529.jpg", Name: "Umpqua River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Whale_Cove_20240531.jpg", Name: "Whale Cove" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Whalehead_20240529.jpg", Name: "Whalehead" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Whiskey_Creek_20240529.jpg", Name: "Whiskey Creek" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Yaquina_Bay_20230905.jpg", Name: "Yaquina Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Yaquina_Head_20240531.jpg", Name: "Yaquina Head" }
        ];


        let currentLocation;
        let shownLocations = []; // Track locations that have already been shown

        // Function to calculate Levenshtein distance (fuzzy matching)
        function levenshteinDistance(a, b) {
            if (a.length === 0) return b.length;
            if (b.length === 0) return a.length;

            const matrix = [];
            for (let i = 0; i <= b.length; i++) {
                matrix[i] = [i];
            }
            for (let j = 0; j <= a.length; j++) {
                matrix[0][j] = j;
            }

            for (let i = 1; i <= b.length; i++) {
                for (let j = 1; j <= a.length; j++) {
                    if (b.charAt(i - 1) === a.charAt(j - 1)) {
                        matrix[i][j] = matrix[i - 1][j - 1];
                    } else {
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j - 1] + 1, // Substitution
                            matrix[i][j - 1] + 1,     // Insertion
                            matrix[i - 1][j] + 1      // Deletion
                        );
                    }
                }
            }

            return matrix[b.length][a.length];
        }

        // Function to load a random location image
        function loadRandomLocation() {
            if (shownLocations.length === locations.length) {
                // All locations have been shown
                endGame();
                return;
            }

            let randomIndex;
            do {
                randomIndex = Math.floor(Math.random() * locations.length);
            } while (shownLocations.includes(randomIndex)); // Ensure no repeats

            shownLocations.push(randomIndex); // Add to shown locations
            currentLocation = locations[randomIndex];
            document.getElementById("locationImage").src = currentLocation.URL;
            document.getElementById("result").innerText = "";
            document.getElementById("guessInput").value = "";
            document.getElementById("guessInput").disabled = false; // Enable input for new guess
            document.getElementById("nextLocationButton").disabled = true; // Disable Next Location button
            document.querySelector("button").disabled = false; // Enable Submit button

            // Update the counter
            updateCounter();
        }

        // Function to check the user's guess with fuzzy matching
        function checkGuess() {
            const userGuess = document.getElementById("guessInput").value.trim();
            const resultDiv = document.getElementById("result");

            const distance = levenshteinDistance(userGuess.toLowerCase(), currentLocation.Name.toLowerCase());

            if (distance === 0) {
                resultDiv.innerText = "Correct! Well done!";
                resultDiv.style.color = "green";
            } else if (distance <= 2) { // Allow for small typos
                resultDiv.innerText = `Close enough! The correct answer is ${currentLocation.Name}.`;
                resultDiv.style.color = "orange";
            } else {
                resultDiv.innerText = `Incorrect! The correct answer is ${currentLocation.Name}.`;
                resultDiv.style.color = "red";
            }

            // Disable the Submit button after submitting a guess
            document.querySelector("button").disabled = true;
            // Enable the Next Location button
            document.getElementById("nextLocationButton").disabled = false;
        }

        // Function to advance to the next location
        function nextLocation() {
            loadRandomLocation();
        }

        // Function to end the game and show the montage
        function endGame() {
            document.getElementById("result").innerText = "Game Over! You've seen all the locations.";
            document.getElementById("locationImage").src = "";
            document.getElementById("guessInput").disabled = true;
            document.querySelector("button").disabled = true;
            document.getElementById("nextLocationButton").disabled = true;

            // Show the montage
            const montage = document.getElementById("montage");
            montage.style.display = "block";

            const montageImages = document.getElementById("montageImages");
            montageImages.innerHTML = ""; // Clear any existing images

            // Add all shown location images to the montage
            shownLocations.forEach(index => {
                const img = document.createElement("img");
                img.src = locations[index].URL;
                img.alt = locations[index].Name;
                montageImages.appendChild(img);
            });
        }

        // Function to toggle the location list visibility
        function toggleLocationList() {
            const locationList = document.getElementById("locationList");
            const toggle = document.getElementById("toggleLocationList");

            if (toggle.checked) {
                locationList.style.display = "block";
                updateLocationList();
            } else {
                locationList.style.display = "none";
            }
        }

        // Function to update the location list
        function updateLocationList() {
            const locationListItems = document.getElementById("locationListItems");
            locationListItems.innerHTML = ""; // Clear the list
            locations.forEach(location => {
                const li = document.createElement("li");
                li.innerText = location.Name;
                locationListItems.appendChild(li);
            });
        }

        // Function to update the counter
        function updateCounter() {
            const counter = document.getElementById("counter");
            counter.innerText = `${shownLocations.length} of ${locations.length}`;
        }

        // Load the first location when the page loads
        window.onload = loadRandomLocation;
    </script>

</body>
</html>