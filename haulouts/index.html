<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oregon Coast Haulout Location Quiz</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .container { 
            margin-top: 30px; 
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .form-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input { 
            margin: 5px; 
            padding: 8px; 
            width: 80%;
            max-width: 300px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button { 
            padding: 10px 15px; 
            cursor: pointer; 
            margin: 10px 5px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #0069d9;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin-bottom: 20px;
            max-height: 400px;
            object-fit: cover;
        }
        #result {
            margin: 15px 0;
            padding: 10px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 18px;
        }
        .correct {
            background-color: #dff0d8;
            color: #3c763d;
        }
        .incorrect {
            background-color: #f2dede;
            color: #a94442;
        }
        .close {
            background-color: #fcf8e3;
            color: #8a6d3b;
        }
        .progress {
            margin: 20px 0;
            font-size: 14px;
        }
        #location-list {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 8px;
            text-align: left;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }
        #location-list h3 {
            margin-top: 0;
        }
        .location-chips {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
        }
        .location-chip {
            background-color: #e0e0e0;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 14px;
            margin: 4px;
            display: inline-block;
        }
        .toggle-list {
            background-color: #007bff;
            color: white;
        }
        .toggle-list:hover {
            background-color: #0069d9;
        }
        #montage {
            display: none;
            margin-top: 30px;
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        #montage h2 {
            margin-top: 0;
        }
        .montage-images {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .montage-images img {
            width: 150px;
            height: 100px;
            object-fit: cover;
            border-radius: 5px;
            margin: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Oregon Coast Haulout Location Quiz</h1>
        <p>Look at the picture below and guess the name of the haulout location!</p>
        
        <div id="quiz-controls">
            <button id="start-button" onclick="startQuiz()">Start Quiz</button>
            <p class="progress hidden" id="progress">Image <span id="current-question">0</span> of <span id="total-questions">0</span></p>
        </div>
        
        <div id="quiz-area" class="hidden">
            <img id="locationImage" src="" alt="Haulout Location Image">
            
            <form id="answer-form" onsubmit="checkGuess(event)">
                <div class="form-group">
                    <label for="guessInput">Location Name:</label>
                    <input type="text" id="guessInput" placeholder="Enter haulout location" required>
                </div>
                
                <button type="submit" id="submit-button">Submit Answer</button>
            </form>
            
            <div id="result" aria-live="assertive"></div>
            
            <button id="next-button" class="hidden" onclick="nextLocation()" disabled>Next Location</button>
            
            <button id="toggle-locations" class="toggle-list" onclick="toggleLocationList()">Show/Hide Location List</button>
            
            <div id="location-list">
                <h3>All Locations (Alphabetically Sorted):</h3>
                <div class="location-chips" id="location-chips"></div>
            </div>
        </div>
        
        <div id="montage">
            <h2>Game Over! Here are all the locations you saw:</h2>
            <div class="montage-images" id="montageImages"></div>
        </div>
    </div>
    
    <script>
        // Oregon coast haulout locations with images
        const locations = [
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Alsea_Bay_20240531.jpg", Name: "Alsea Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Bandon_20240529.jpg", Name: "Bandon" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Blacklock_Point_20240529.jpg", Name: "Blacklock Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Blanco_Reef_20240529.jpg", Name: "Blanco Reef" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Boiler_Bay_20240531.jpg", Name: "Boiler Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Camas_Powerlines_20230427.jpg", Name: "Camas Powerlines" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Arago_20230905.jpg", Name: "Cape Arago" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Blanco_20240529.jpg", Name: "Cape Blanco" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Falcon_20240531.jpg", Name: "Cape Falcon" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Foulweather_20240531.jpg", Name: "Cape Foulweather" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Lookout_20240531.jpg", Name: "Cape Lookout" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cape_Perpetua_20240529.jpg", Name: "Cape Perpetua" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cascade_Head_20230905.jpg", Name: "Cascade Head" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Castle_Rock_20240529.jpg", Name: "Castle Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Chinook_Baker_20210518.jpg", Name: "Baker Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Coffin_Rock_20250109.jpg", Name: "Coffin Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Coos_Bay_20240529.jpg", Name: "Coos Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Cowlitz_River_Mouth_20220323.jpg", Name: "Cowlitz River Mouth" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Deer_Point_20240529.jpg", Name: "Deer Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Desdemona_Sands_20240531.jpg", Name: "Desdemona Sands" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Devils_Backbone_20240529.jpg", Name: "Devils Backbone" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/East_Mooring_Basin_20230905.jpg", Name: "East Mooring Basin" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Ecola_Point_20240531.jpg", Name: "Ecola Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Fivemile_Point_20240529.jpg", Name: "Fivemile Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Fogarty_Creek_20240531.jpg", Name: "Fogarty Creek" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Goat_Island_20240529.jpg", Name: "Goat Island" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Grays_Bay_20240531.jpg", Name: "Grays Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Green_Island_Area_20240531.jpg", Name: "Green Island Area" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Gull_Rock_20240529.jpg", Name: "Gull Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/House_Rock_20240529.jpg", Name: "House Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Hubbard_Mound_20240529.jpg", Name: "Hubbard Mound" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Humbug_Mountain_20240529.jpg", Name: "Humbug Mountain" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Hunters_Island_20240529.jpg", Name: "Hunters Island" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Jetty_A_20240531.jpg", Name: "Jetty A" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Mack_Reef_Crook_Point_20230905.jpg", Name: "Mack Reef Crook Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Nehalem_River_20240531.jpg", Name: "Nehalem River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Nestucca_River_20240531.jpg", Name: "Nestucca River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Netarts_Bay_20240531.jpg", Name: "Netarts Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Orford_Reef_20230905.jpg", Name: "Orford Reef" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Phoca_Rock_20100317.jpg", Name: "Phoca Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Pillar_Welch_20210518.jpg", Name: "Three Tree Point" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Pirate_Cove_20240531.jpg", Name: "Pirate Cove" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Pistol_River_20240529.jpg", Name: "Pistol River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Port_Orford_Heads_20240529.jpg", Name: "Port Orford Heads" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Puget_Wallace_20210518.jpg", Name: "Wallace Island" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Qochyax_Island_20240529.jpg", Name: "Qochyax Island" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Rainier_20240208.jpg", Name: "Rainier" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Rogue_Reef_20240529.jpg", Name: "Rogue Reef" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Rogue_River_20240529.jpg", Name: "Rogue River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Sea_Lion_Caves_20230905.jpg", Name: "Sea Lion Caves" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Seal_Rock_20240531.jpg", Name: "Seal Rock" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Shore_Acres_20240529.jpg", Name: "Shore Acres" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Siletz_Bay_20240531.jpg", Name: "Siletz Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Siltcoos_Lake_Outlet_20240529.jpg", Name: "Siltcoos Lake Outlet" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Siuslaw_River_20240529.jpg", Name: "Siuslaw River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/South_Jetty_20230905.jpg", Name: "South Jetty" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Strawberry_Hill_20240529.jpg", Name: "Strawberry Hill" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tahkenitch_Lake_Outlet_20240529.jpg", Name: "Tahkenitch Lake Outlet" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Taylor_Sands_20240531.jpg", Name: "Taylor Sands" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tenmile_Lake_Outlet_20240529.jpg", Name: "Tenmile Lake Outlet" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Three_Arch_Rocks_20230905.jpg", Name: "Three Arch Rocks" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tillamook_Bay_20240531.jpg", Name: "Tillamook Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tillamook_Head_20240531.jpg", Name: "Tillamook Head" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tillamook_Head_Lighthouse_20230905.jpg", Name: "Tillamook Head Lighthouse" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Tokatee_Klootchman_20240529.jpg", Name: "Tokatee Klootchman" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Umpqua_River_20240529.jpg", Name: "Umpqua River" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Whale_Cove_20240531.jpg", Name: "Whale Cove" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Whalehead_20240529.jpg", Name: "Whalehead" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Whiskey_Creek_20240529.jpg", Name: "Whiskey Creek" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Yaquina_Bay_20230905.jpg", Name: "Yaquina Bay" },
            { URL: "https://dfw.state.or.us/MRP/mammals/images/haulouts/Yaquina_Head_20240531.jpg", Name: "Yaquina Head" }
        ];
        
        let currentLocation;
        let shownLocations = []; // Track locations that have already been shown
        let quizStarted = false;
        let questionAnswered = false;
        let locationListVisible = false;
        
        function startQuiz() {
            quizStarted = true;
            document.getElementById("quiz-area").classList.remove("hidden");
            document.getElementById("start-button").classList.add("hidden");
            document.getElementById("progress").classList.remove("hidden");
            document.getElementById("total-questions").textContent = locations.length;
            document.getElementById("montage").style.display = "none";
            shownLocations = [];
            populateLocationList();
            nextLocation();
        }
        
        function populateLocationList() {
            const chipContainer = document.getElementById("location-chips");
            chipContainer.innerHTML = "";
            
            // Create a copy of the locations array and sort it alphabetically
            const sortedLocations = [...locations].sort((a, b) => a.Name.localeCompare(b.Name));
            
            // Create a chip for each location
            sortedLocations.forEach(location => {
                const chip = document.createElement("span");
                chip.className = "location-chip";
                chip.textContent = location.Name;
                chipContainer.appendChild(chip);
            });
        }
        
        function toggleLocationList() {
            const locationList = document.getElementById("location-list");
            locationListVisible = !locationListVisible;
            
            if (locationListVisible) {
                locationList.style.display = "block";
            } else {
                locationList.style.display = "none";
            }
        }
        
        // Function to load a random location image
        function nextLocation() {
            if (shownLocations.length === locations.length) {
                // All locations have been shown
                endQuiz();
                return;
            }
            
            let randomIndex;
            do {
                randomIndex = Math.floor(Math.random() * locations.length);
            } while (shownLocations.includes(randomIndex)); // Ensure no repeats
            
            shownLocations.push(randomIndex); // Add to shown locations
            currentLocation = locations[randomIndex];
            document.getElementById("locationImage").src = currentLocation.URL;
            document.getElementById("locationImage").alt = "Image of a haulout location to identify";
            
            document.getElementById("result").textContent = "";
            document.getElementById("result").className = "";
            document.getElementById("guessInput").value = "";
            document.getElementById("next-button").classList.add("hidden");
            document.getElementById("next-button").disabled = true;
            document.getElementById("submit-button").disabled = false;
            document.getElementById("guessInput").focus();
            
            document.getElementById("current-question").textContent = shownLocations.length;
            questionAnswered = false;
        }
        
        // Function to calculate Levenshtein distance (fuzzy matching)
        function levenshteinDistance(a, b) {
            if (a.length === 0) return b.length;
            if (b.length === 0) return a.length;
            
            const matrix = [];
            for (let i = 0; i <= b.length; i++) {
                matrix[i] = [i];
            }
            for (let j = 0; j <= a.length; j++) {
                matrix[0][j] = j;
            }
            
            for (let i = 1; i <= b.length; i++) {
                for (let j = 1; j <= a.length; j++) {
                    if (b.charAt(i - 1) === a.charAt(j - 1)) {
                        matrix[i][j] = matrix[i - 1][j - 1];
                    } else {
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j - 1] + 1, // Substitution
                            matrix[i][j - 1] + 1,     // Insertion
                            matrix[i - 1][j] + 1      // Deletion
                        );
                    }
                }
            }
            
            return matrix[b.length][a.length];
        }
        
        // Function to check the user's guess with fuzzy matching
        function checkGuess(event) {
            if (event) event.preventDefault();
            if (questionAnswered) return;
            
            let userGuess = document.getElementById("guessInput").value.trim();
            const resultDiv = document.getElementById("result");
            
            const distance = levenshteinDistance(userGuess.toLowerCase(), currentLocation.Name.toLowerCase());
            
            if (distance === 0) {
                resultDiv.innerText = "Correct! Well done!";
                resultDiv.className = "correct";
            } else if (distance <= 2) { // Allow for small typos
                resultDiv.innerText = `Close enough! The correct answer is ${currentLocation.Name}.`;
                resultDiv.className = "close";
            } else {
                resultDiv.innerText = `Incorrect. The correct answer is ${currentLocation.Name}.`;
                resultDiv.className = "incorrect";
            }
            
            // Disable the Submit button after submitting a guess
            document.getElementById("submit-button").disabled = true;
            // Enable the Next Location button
            document.getElementById("next-button").classList.remove("hidden");
            document.getElementById("next-button").disabled = false;
            
            questionAnswered = true;
        }
        
        function endQuiz() {
            document.getElementById("quiz-area").classList.add("hidden");
            document.getElementById("start-button").classList.remove("hidden");
            document.getElementById("start-button").textContent = "Restart Quiz";
            document.getElementById("progress").classList.add("hidden");
            
            // Show the montage
            document.getElementById("montage").style.display = "block";
            const montageImages = document.getElementById("montageImages");
            montageImages.innerHTML = ""; // Clear any existing images
            
            // Add all shown location images to the montage with their names
            shownLocations.forEach(index => {
                const imgContainer = document.createElement("div");
                imgContainer.style.position = "relative";
                imgContainer.style.display = "inline-block";
                
                const img = document.createElement("img");
                img.src = locations[index].URL;
                img.alt = locations[index].Name;
                
                const caption = document.createElement("div");
                caption.textContent = locations[index].Name;
                caption.style.position = "absolute";
                caption.style.bottom = "5px";
                caption.style.left = "0";
                caption.style.right = "0";
                caption.style.backgroundColor = "rgba(0,0,0,0.7)";
                caption.style.color = "white";
                caption.style.padding = "3px";
                caption.style.fontSize = "12px";
                
                imgContainer.appendChild(img);
                imgContainer.appendChild(caption);
                montageImages.appendChild(imgContainer);
            });
        }
        
        // Handle Enter key in the form
        document.getElementById("answer-form").addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                event.preventDefault();
                checkGuess();
            }
        });
        
        // Initialize event listeners when the page loads
        window.onload = function() {
            document.getElementById("quiz-area").classList.add("hidden");
            document.getElementById("start-button").classList.remove("hidden");
            document.getElementById("progress").classList.add("hidden");
        };
    </script>
</body>
</html>